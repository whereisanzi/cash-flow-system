graph TB
  subgraph External[External Actors & Systems]
    Merchant[ğŸ‘¤ Merchant<br/>Comerciante que registra<br/>transaÃ§Ãµes financeiras]
    FinancialAnalyst[ğŸ‘¤ Financial Analyst<br/>Analista que consulta<br/>relatÃ³rios consolidados]
    Auditor[ğŸ‘¤ Auditor<br/>Auditores internos/externos<br/>que verificam compliance]
    LoadTester[ğŸ”§ k6 Load Tester<br/>Sistema de testes<br/>automatizados]

    ExternalIdentity[ğŸ” External Identity Provider<br/>Keycloak - OAuth2/OIDC<br/>GestÃ£o centralizada de identidade]
    Monitoring[ğŸ“ˆ External Monitoring<br/>Prometheus + Grafana<br/>Observabilidade empresarial]
  end

  subgraph CashFlowSystem[Cash Flow System - Bounded Contexts]
    subgraph TransactionContext[ğŸ”· Transaction Management Context<br/>Core Domain]
      TransactionBC[GestÃ£o de MovimentaÃ§Ã£o Financeira<br/>â€¢ Registro de transaÃ§Ãµes<br/>â€¢ ValidaÃ§Ã£o de regras de negÃ³cio<br/>â€¢ NotificaÃ§Ã£o de eventos]
    end

    subgraph ConsolidationContext[ğŸ”· Financial Consolidation Context<br/>Supporting Domain]
      ConsolidationBC[ConsolidaÃ§Ã£o de Saldos<br/>â€¢ AgregaÃ§Ã£o de dados<br/>â€¢ CÃ¡lculos de saldo<br/>â€¢ GeraÃ§Ã£o de relatÃ³rios]
    end

    subgraph AuditContext[ğŸ”· Financial Audit Context<br/>Supporting Domain]
      AuditBC[Auditoria e Compliance<br/>â€¢ Trilha de auditoria<br/>â€¢ Registros imutÃ¡veis<br/>â€¢ RelatÃ³rios de compliance]
    end

    subgraph MerchantContext[ğŸ”· Merchant Management Context<br/>Generic Subdomain]
      MerchantBC[GestÃ£o de Identidade<br/>â€¢ AutenticaÃ§Ã£o<br/>â€¢ AutorizaÃ§Ã£o<br/>â€¢ Isolamento multi-tenant]
    end
  end

  %% Business Interactions
  Merchant -->|"Registra transaÃ§Ãµes<br/>para controle financeiro"| TransactionBC
  FinancialAnalyst -->|"Consulta consolidados<br/>para acompanhar faturamento"| ConsolidationBC
  Auditor -->|"Acessa trilhas<br/>para verificar compliance"| AuditBC

  LoadTester -->|"Testa performance<br/>e NFRs"| TransactionBC
  LoadTester -->|"Valida escalabilidade"| ConsolidationBC

  %% Context Integration
  TransactionBC -.->|"Eventos de transaÃ§Ã£o"| ConsolidationBC
  TransactionBC -.->|"Logs de auditoria"| AuditBC
  ConsolidationBC -.->|"Registros de cÃ¡lculo"| AuditBC

  %% External Dependencies
  MerchantBC -.->|"DelegaÃ§Ã£o de autenticaÃ§Ã£o"| ExternalIdentity
  TransactionBC -.->|"MÃ©tricas de performance"| Monitoring
  ConsolidationBC -.->|"MÃ©tricas de agregaÃ§Ã£o"| Monitoring
  AuditBC -.->|"MÃ©tricas de compliance"| Monitoring

  %% Styling
  classDef actor fill:#e8f4fd,stroke:#1976d2,stroke-width:2px
  classDef context fill:#fff3e0,stroke:#f57c00,stroke-width:3px
  classDef external fill:#f5f5f5,stroke:#616161,stroke-width:2px
  classDef core fill:#e8f5e8,stroke:#2e7d32,stroke-width:4px
  classDef supporting fill:#e3f2fd,stroke:#1976d2,stroke-width:3px
  classDef generic fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px

  class Merchant,FinancialAnalyst,Auditor,LoadTester actor
  class ExternalIdentity,Monitoring external
  class TransactionBC core
  class ConsolidationBC,AuditBC supporting
  class MerchantBC generic